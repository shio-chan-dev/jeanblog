<!DOCTYPE html>
<html lang="zh" dir="auto" data-theme="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>咒语与药水的成功组合：排序 &#43; 二分查找秒杀乘积约束问题 | Jeanphilo Blog</title>
<meta name="keywords" content="spells and potions, successful pairs, 二分查找, 排序, 乘积约束, LeetCode 2300">
<meta name="description" content="给定 spells 和 potions 两个数组以及 success 阈值，如何用排序 &#43; 二分查找在 O((n&#43;m)log m) 时间内求出每个咒语能与多少药水形成乘积 ≥ success 的成功组合，并给出多语言实现与工程应用示例。">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/alg/leetcode/spells-and-potions-successful-pairs/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css" integrity="sha256-NDzEgLn/yPBMy&#43;XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="http://localhost:1313/alg/leetcode/spells-and-potions-successful-pairs/">
<link rel="alternate" hreflang="en" href="http://localhost:1313/en/alg/leetcode/spells-and-potions-successful-pairs/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="http://localhost:1313/alg/leetcode/spells-and-potions-successful-pairs/">
  <meta property="og:site_name" content="Jeanphilo Blog">
  <meta property="og:title" content="咒语与药水的成功组合：排序 &#43; 二分查找秒杀乘积约束问题">
  <meta property="og:description" content="给定 spells 和 potions 两个数组以及 success 阈值，如何用排序 &#43; 二分查找在 O((n&#43;m)log m) 时间内求出每个咒语能与多少药水形成乘积 ≥ success 的成功组合，并给出多语言实现与工程应用示例。">
  <meta property="og:locale" content="zh-cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="alg">
    <meta property="article:published_time" content="2025-12-04T10:50:00+08:00">
    <meta property="article:modified_time" content="2025-12-04T10:50:00+08:00">
    <meta property="article:tag" content="二分查找">
    <meta property="article:tag" content="排序">
    <meta property="article:tag" content="数组">
    <meta property="article:tag" content="双指针">
    <meta property="article:tag" content="面试高频题">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="咒语与药水的成功组合：排序 &#43; 二分查找秒杀乘积约束问题">
<meta name="twitter:description" content="给定 spells 和 potions 两个数组以及 success 阈值，如何用排序 &#43; 二分查找在 O((n&#43;m)log m) 时间内求出每个咒语能与多少药水形成乘积 ≥ success 的成功组合，并给出多语言实现与工程应用示例。">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "算法",
      "item": "http://localhost:1313/alg/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "leetcode",
      "item": "http://localhost:1313/alg/leetcode/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "咒语与药水的成功组合：排序 + 二分查找秒杀乘积约束问题",
      "item": "http://localhost:1313/alg/leetcode/spells-and-potions-successful-pairs/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "咒语与药水的成功组合：排序 + 二分查找秒杀乘积约束问题",
  "name": "咒语与药水的成功组合：排序 \u002b 二分查找秒杀乘积约束问题",
  "description": "给定 spells 和 potions 两个数组以及 success 阈值，如何用排序 + 二分查找在 O((n+m)log m) 时间内求出每个咒语能与多少药水形成乘积 ≥ success 的成功组合，并给出多语言实现与工程应用示例。",
  "keywords": [
    "spells and potions", "successful pairs", "二分查找", "排序", "乘积约束", "LeetCode 2300"
  ],
  "articleBody": " 副标题 / 摘要\n一道典型的“乘积 ≥ 阈值”计数题，看起来像是 O(n²) 的双重循环，实际上用「排序 + 二分查找」就能把复杂度压到 O((n+m)log m)。本文从题意抽象、核心公式到多语言实现，带你把这类阈值匹配问题彻底吃透。\n预计阅读时长：10~15 分钟 适用场景标签：二分查找、排序计数、阈值匹配 SEO 关键词：spells and potions, successful pairs, 二分查找, lower_bound, 乘积约束 目标读者与背景 目标读者\n已熟悉基本二分查找，想提升「在有序数组上做计数」能力的同学 后端 / 算法工程师，经常处理阈值判断与配对统计的问题 准备技术面试，希望积累“排序 + 二分”模板的开发者 为什么这题值得单独写一篇？\n它把一个表面 O(n²) 的「所有配对」问题，转化成了对有序数组的二分计数； 公式非常典型：把 a * b ≥ success 转成 b ≥ ceil(success / a)； 这种思路在推荐系统、风控额度、资源匹配等业务里屡见不鲜。 A — Algorithm（题目与算法） 题目重述 给定两个整数数组 spells 和 potions，以及一个正整数 success。\n对于每个咒语 spells[i]，我们定义它与药水 potions[j] 的组合是“成功”的，当且仅当：\nspells[i] * potions[j] \u003e= success\n请返回一个数组 ans，其中 ans[i] 表示第 i 个咒语可以与多少个药水形成成功组合。\n输入\nspells: 长度为 n 的整数数组 potions: 长度为 m 的整数数组 success: 正整数阈值 输出\n整数数组 ans，长度为 n，ans[i] 为每个 spells[i] 能匹配的成功药水数量 示例 spells = [5, 1, 3] potions = [1, 2, 3, 4, 5] success = 7 对每个咒语：\nspell = 5：\n需要 5 * potion \u003e= 7 → potion \u003e= 7/5 = 1.4，向上取整得到 potion \u003e= 2\n在 potions 中满足的是 [2, 3, 4, 5]，一共 4 个\nspell = 1：\n需要 1 * potion \u003e= 7 → potion \u003e= 7\npotions 里最大也只有 5，所以是 0 个\nspell = 3：\n需要 3 * potion \u003e= 7 → potion \u003e= 7/3 ≈ 2.33，向上取整得到 potion \u003e= 3\n满足的是 [3, 4, 5]，一共 3 个\n因此答案为：\nans = [4, 0, 3] C — Concepts（核心思想） 1. 从乘积约束到「下界」问题 对固定的咒语值 s = spells[i]，成功条件是：\ns * potions[j] \u003e= success 假设我们只考虑 s \u003e 0（若题目存在 0 或负数可额外讨论），可以等价变形为：\npotions[j] \u003e= success / s 由于 potions[j] 和 success 是整数，我们要满足：\npotions[j] \u003e= ceil(success / s) 记：\nneed = ceil(success / s) 注意：\n不要使用浮点数，用整数安全实现向上取整的公式：\nneed = (success + s - 1) // s 这样，每个咒语的问题就变成了：\n在数组 potions 中，找到第一个 ≥ need 的位置，下标记为 idx，\n则从 idx 到末尾 m-1 的所有药水都满足条件，总数为 m - idx。\n这正是一个标准的「有序数组上找下界（lower_bound）」的问题。\n2. 为什么要排序？ 二分查找的前提是数组有序。\n我们可以：\n单独对 potions 排序（不影响题意，因为只关心数量，不关心原下标）； 对每个咒语 s： 计算 need = ceil(success / s) 在排序后的 potions 中，二分找到第一个 \u003e= need 的位置 idx 对应成功数为 m - idx 这样就避免了遍历整个 potions 数组的 O(m) 操作，每个咒语只需 O(log m)。\n3. 算法类型与复杂度 算法类型：排序 + 二分查找（lower_bound） 时间复杂度： 排序 potions: O(m log m) 对每个 spells[i] 做一次二分：O(n log m) 总体：O((n + m) log m) 空间复杂度： 如果在原地排序：O(1) 额外空间（忽略递归栈） 与暴力方法 O(n·m) 相比，在 n, m 均为 1e5 级别时，差距非常明显。\n实践指南 / 实现步骤 排序 potions\n使用语言内置排序即可（如 sort.Ints、std::sort）。 遍历每个咒语 s\n若 s == 0，则 s * potions[j] 永远是 0，不可能 ≥ 正数 success，答案为 0；\n否则计算：\nneed = (success + s - 1) // s 在排序好的 potions 上二分\n找到第一个 potions[idx] \u003e= need 的位置； 若 idx == m（越界），说明不存在满足条件的药水，结果为 0； 否则结果为 m - idx。 收集结果\n为每个咒语记录这一数量，输出数组 ans。 边界检查\nspells 或 potions 为空时，直接返回全 0； 注意使用足够大的整数类型保存中间结果（如 long long / int64）。 E — Engineering（工程应用） 下面用三个实际场景，说明这种「排序 + 阈值二分计数」在工程里的用法。\n场景 1：定价与优惠组合评估（Python） 背景\n你有一批商品价格（咒语）和一批折扣系数（药水，例如 0.9、0.8）。你想知道：\n对每个商品，有多少种折扣方案会让折后收入仍然大于某个阈值？\n虽然实际业务多是浮点运算，这里可以简化为整数乘积与阈值比较。\n示例代码\nfrom bisect import bisect_left from typing import List def successful_pairs(spells: List[int], potions: List[int], success: int) -\u003e List[int]: potions.sort() m = len(potions) ans = [] for s in spells: if s == 0: ans.append(0) continue need = (success + s - 1) // s # ceil idx = bisect_left(potions, need) ans.append(m - idx) return ans if __name__ == \"__main__\": print(successful_pairs([5, 1, 3], [1, 2, 3, 4, 5], 7)) # [4, 0, 3] 场景 2：风控额度组合估算（Go） 背景\n在风控系统中：\nspells[i] 可以看作借款金额； potions[j] 可以看作担保倍数 / 抵押倍数； success 是一个安全阈值，例如“风险缓释程度”。 你希望知道对每一笔借款金额 spells[i]，有多少种担保方案可以让：\n借款金额 * 担保倍数 \u003e= success 示例代码\npackage main import ( \"fmt\" \"sort\" ) func successfulPairs(spells []int, potions []int, success int64) []int { sort.Ints(potions) m := len(potions) ans := make([]int, len(spells)) for i, s := range spells { if s == 0 { ans[i] = 0 continue } need := (success + int64(s) - 1) / int64(s) idx := sort.Search(m, func(j int) bool { return int64(potions[j]) \u003e= need }) ans[i] = m - idx } return ans } func main() { fmt.Println(successfulPairs([]int{5, 1, 3}, []int{1, 2, 3, 4, 5}, 7)) // [4 0 3] } 场景 3：前端优惠券 × 商品匹配（JavaScript） 背景\n在前端你有：\nspells[i]：商品价格； potions[j]：折扣倍数（可近似映射为整数、比方说扩大 100 倍做整数算再除回去）； 你需要计算每个商品能和多少优惠券组合，使得折后价乘以某个指标仍然 ≥ success。 虽然真实逻辑可能更复杂，但核心都是「一个数组排序，另外一个数组的每个元素用二分找到阈值位置」。\n示例代码\nfunction successfulPairs(spells, potions, success) { potions.sort((a, b) =\u003e a - b); const m = potions.length; const ans = []; for (const s of spells) { if (s === 0) { ans.push(0); continue; } const need = Math.ceil(success / s); let l = 0, r = m; while (l \u003c r) { const mid = (l + r) \u003e\u003e 1; if (potions[mid] \u003e= need) r = mid; else l = mid + 1; } ans.push(m - l); } return ans; } console.log(successfulPairs([5, 1, 3], [1, 2, 3, 4, 5], 7)); // [4, 0, 3] R — Reflection（反思与深入） 1. 复杂度分析 排序 potions：O(m log m)\n对每个咒语进行二分：O(n log m)\n总体时间复杂度：O((n + m) log m)\n在 n, m ~ 1e5 的情况下完全可行。\n空间复杂度：\n原地排序时，额外空间 O(1)（或 O(log m) 递归栈）。 相比之下，暴力双重循环的复杂度为 O(n·m)，在大规模数据时会直接超时或导致请求超时。\n2. 替代方案与常见错误 暴力法：\nfor s in spells: cnt = 0 for p in potions: if s * p \u003e= success: cnt++ ans[i] = cnt 时间复杂度 O(n·m)； 完全没利用 potions 数组的可重用性和有序性。 双指针 + 排序（另一种思路）\n也可以同时排序 spells（带原下标）和 potions，使用双指针从右往左移动，统计每个咒语能匹配的药水个数； 这也是常见解法之一，但实现上更容易写错边界，对初学者不如二分方案直观。 常见错误\n直接计算乘积比较导致溢出\n如果 spells[i] 和 potions[j] 都是 1e9 级别，用 32 位整数相乘会溢出； 推荐用除法：p \u003e= ceil(success / s)，从而避免 s * p 直接计算； 向上取整写错\n常见错误写法：need = success / s（这是向下取整，会漏掉边界值）； 正确：need = (success + s - 1) // s。 忘记排序 potions 再二分\n二分查找必须建立在有序数组之上，否则结果不可预测。 忽略 s == 0 的情况\n若题目允许 spells 中出现 0，需要特判：0 乘以任何非负数都不可能 ≥ 正数 success。 3. 为什么“排序 + 二分”更工程可行？ 可读性好：\n代码结构清晰：排序一次 + 每个元素做一次二分；\n很容易被团队中其他人理解和复用。\n性能稳健：\n二分查找操作的复杂度非常稳定，主要耗时集中在排序上；\n在数据量很大时也有良好表现。\n可扩展性强：\n许多类似 “a * b ≥ C” / “a + b ≥ C” / “b ≥ f(a)” 的匹配计数问题都可以按同样方式建模。\nS — Summary（总结） 把 spells[i] * potions[j] \u003e= success 转换为 potions[j] \u003e= ceil(success / spells[i]) 是本题的核心。 通过对 potions 排序，并对每个咒语用二分查找找“第一个 ≥ need 的位置”，我们可以在 O((n+m)log m) 时间内解题。 相比暴力 O(n·m) 的双重循环，排序 + 二分在大数据场景下更具工程价值。 注意处理整数向上取整、溢出风险以及 s == 0 等边界条件。 这种模式可以迁移到价格组合、风险额度、资源匹配等多个业务场景。 参考与延伸阅读 LeetCode 2300. Successful Pairs of Spells and Potions（原题） 其他典型的「排序 + 二分计数」问题： 三数之和 / 四数之和中的去重与剪枝 统计区间内小于 / 大于某值的元素个数 《算法导论》排序与二分查找章节 各主流语言标准库的二分查找接口：bisect（Python）、std::lower_bound（C++）、sort.Search（Go）等 多语言完整实现（Python / C / C++ / Go / Rust / JS） Python 实现 from bisect import bisect_left from typing import List def successful_pairs(spells: List[int], potions: List[int], success: int) -\u003e List[int]: potions.sort() m = len(potions) ans = [] for s in spells: if s == 0: ans.append(0) continue need = (success + s - 1) // s idx = bisect_left(potions, need) ans.append(m - idx) return ans if __name__ == \"__main__\": print(successful_pairs([5, 1, 3], [1, 2, 3, 4, 5], 7)) # [4, 0, 3] C 实现 #include #include int cmp_int(const void *a, const void *b) { int x = *(const int *)a; int y = *(const int *)b; return (x \u003e y) - (x \u003c y); } int lower_bound(int *arr, int n, int target) { int l = 0, r = n; while (l \u003c r) { int mid = l + (r - l) / 2; if (arr[mid] \u003e= target) r = mid; else l = mid + 1; } return l; } void successfulPairs(int *spells, int n, int *potions, int m, long long success, int *ans) { qsort(potions, m, sizeof(int), cmp_int); for (int i = 0; i \u003c n; ++i) { int s = spells[i]; if (s == 0) { ans[i] = 0; continue; } long long need_ll = (success + s - 1) / s; if (need_ll \u003e potions[m - 1]) { ans[i] = 0; continue; } int need = (int)need_ll; int idx = lower_bound(potions, m, need); ans[i] = m - idx; } } int main(void) { int spells[] = {5, 1, 3}; int potions[] = {1, 2, 3, 4, 5}; int n = 3, m = 5; int ans[3]; successfulPairs(spells, n, potions, m, 7, ans); for (int i = 0; i \u003c n; ++i) { printf(\"%d \", ans[i]); } printf(\"\\n\"); // 4 0 3 return 0; } C++ 实现 #include using namespace std; vector\u003cint\u003e successfulPairs(vector\u003cint\u003e spells, vector\u003cint\u003e potions, long long success) { sort(potions.begin(), potions.end()); int m = (int)potions.size(); vector\u003cint\u003e ans; ans.reserve(spells.size()); for (int s : spells) { if (s == 0) { ans.push_back(0); continue; } long long need = (success + s - 1) / s; auto it = lower_bound(potions.begin(), potions.end(), (int)need); ans.push_back((int)(potions.end() - it)); } return ans; } int main() { vector\u003cint\u003e spells{5, 1, 3}; vector\u003cint\u003e potions{1, 2, 3, 4, 5}; auto ans = successfulPairs(spells, potions, 7); for (int x : ans) cout \u003c\u003c x \u003c\u003c \" \"; cout \u003c\u003c endl; // 4 0 3 return 0; } Go 实现 package main import ( \"fmt\" \"sort\" ) func successfulPairs(spells []int, potions []int, success int64) []int { sort.Ints(potions) m := len(potions) ans := make([]int, len(spells)) for i, s := range spells { if s == 0 { ans[i] = 0 continue } need := (success + int64(s) - 1) / int64(s) idx := sort.Search(m, func(j int) bool { return int64(potions[j]) \u003e= need }) ans[i] = m - idx } return ans } func main() { fmt.Println(successfulPairs([]int{5, 1, 3}, []int{1, 2, 3, 4, 5}, 7)) // [4 0 3] } Rust 实现 fn successful_pairs(spells: Vec\u003ci32\u003e, mut potions: Vec\u003ci32\u003e, success: i64) -\u003e Vec\u003ci32\u003e { potions.sort(); let m = potions.len(); let mut ans = Vec::with_capacity(spells.len()); for s in spells { if s == 0 { ans.push(0); continue; } let need = (success + s as i64 - 1) / s as i64; let idx = potions .binary_search_by(|\u0026p| { if (p as i64) \u003c need { std::cmp::Ordering::Less } else { std::cmp::Ordering::Greater } }) .unwrap_or_else(|i| i); ans.push((m - idx) as i32); } ans } fn main() { let spells = vec![5, 1, 3]; let potions = vec![1, 2, 3, 4, 5]; let ans = successful_pairs(spells, potions, 7); println!(\"{:?}\", ans); // [4, 0, 3] } JavaScript 实现 function successfulPairs(spells, potions, success) { potions.sort((a, b) =\u003e a - b); const m = potions.length; const ans = []; for (const s of spells) { if (s === 0) { ans.push(0); continue; } const need = Math.ceil(success / s); let l = 0, r = m; while (l \u003c r) { const mid = (l + r) \u003e\u003e 1; if (potions[mid] \u003e= need) r = mid; else l = mid + 1; } ans.push(m - l); } return ans; } console.log(successfulPairs([5, 1, 3], [1, 2, 3, 4, 5], 7)); // [4, 0, 3] 行动号召（CTA） 把这道题按你最熟悉的语言手写一遍，并把「排序 + 下界二分」抽成一个通用工具函数。 回顾你项目中的阈值匹配逻辑，看能否用“先排序再二分计数”的方式重构一处性能瓶颈。 挑几道类似的「≥ 阈值配对计数」题（如配对和 ≥ K、配对差值 ≤ K），试着用同样思路建模并实现。 ",
  "wordCount" : "1597",
  "inLanguage": "zh",
  "datePublished": "2025-12-04T10:50:00+08:00",
  "dateModified": "2025-12-04T10:50:00+08:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/alg/leetcode/spells-and-potions-successful-pairs/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Jeanphilo Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Jeanphilo Blog (Alt + H)">Jeanphilo Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                    <ul class="lang-switch"><li>|</li>
                        <li>
                            <a href="http://localhost:1313/en/" title="English"
                                aria-label="English">En</a>
                        </li>
                    </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/archives/" title="文章归档">
                    <span>归档</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/dev/" title="开发">
                    <span>开发</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/alg/" title="算法">
                    <span>算法</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="搜索 (Alt &#43; /)" accesskey=/>
                    <span>搜索</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/categories/" title="Categories">
                    <span>分类</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>标签</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">主页</a>&nbsp;»&nbsp;<a href="http://localhost:1313/alg/">算法</a>&nbsp;»&nbsp;<a href="http://localhost:1313/alg/leetcode/">leetcode</a></div>
    <h1 class="post-title entry-hint-parent">
      咒语与药水的成功组合：排序 &#43; 二分查找秒杀乘积约束问题
    </h1>
    <div class="post-description">
      给定 spells 和 potions 两个数组以及 success 阈值，如何用排序 &#43; 二分查找在 O((n&#43;m)log m) 时间内求出每个咒语能与多少药水形成乘积 ≥ success 的成功组合，并给出多语言实现与工程应用示例。
    </div>
    <div class="post-meta"><span title='2025-12-04 10:50:00 +0800 HKT'>2025年12月4日</span>&nbsp;·&nbsp;<span>8 分钟</span>&nbsp;|&nbsp;<span>语言:</span>
<ul class="i18n_list">
    <li>
        <a href="http://localhost:1313/en/alg/leetcode/spells-and-potions-successful-pairs/">En</a>
    </li>
</ul>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">目录</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e7%9b%ae%e6%a0%87%e8%af%bb%e8%80%85%e4%b8%8e%e8%83%8c%e6%99%af" aria-label="目标读者与背景">目标读者与背景</a></li>
                <li>
                    <a href="#a--algorithm%e9%a2%98%e7%9b%ae%e4%b8%8e%e7%ae%97%e6%b3%95" aria-label="A — Algorithm（题目与算法）">A — Algorithm（题目与算法）</a><ul>
                        
                <li>
                    <a href="#%e9%a2%98%e7%9b%ae%e9%87%8d%e8%bf%b0" aria-label="题目重述">题目重述</a></li>
                <li>
                    <a href="#%e7%a4%ba%e4%be%8b" aria-label="示例">示例</a></li></ul>
                </li>
                <li>
                    <a href="#c--concepts%e6%a0%b8%e5%bf%83%e6%80%9d%e6%83%b3" aria-label="C — Concepts（核心思想）">C — Concepts（核心思想）</a><ul>
                        
                <li>
                    <a href="#1-%e4%bb%8e%e4%b9%98%e7%a7%af%e7%ba%a6%e6%9d%9f%e5%88%b0%e4%b8%8b%e7%95%8c%e9%97%ae%e9%a2%98" aria-label="1. 从乘积约束到「下界」问题">1. 从乘积约束到「下界」问题</a></li>
                <li>
                    <a href="#2-%e4%b8%ba%e4%bb%80%e4%b9%88%e8%a6%81%e6%8e%92%e5%ba%8f" aria-label="2. 为什么要排序？">2. 为什么要排序？</a></li>
                <li>
                    <a href="#3-%e7%ae%97%e6%b3%95%e7%b1%bb%e5%9e%8b%e4%b8%8e%e5%a4%8d%e6%9d%82%e5%ba%a6" aria-label="3. 算法类型与复杂度">3. 算法类型与复杂度</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%ae%9e%e8%b7%b5%e6%8c%87%e5%8d%97--%e5%ae%9e%e7%8e%b0%e6%ad%a5%e9%aa%a4" aria-label="实践指南 / 实现步骤">实践指南 / 实现步骤</a></li>
                <li>
                    <a href="#e--engineering%e5%b7%a5%e7%a8%8b%e5%ba%94%e7%94%a8" aria-label="E — Engineering（工程应用）">E — Engineering（工程应用）</a><ul>
                        
                <li>
                    <a href="#%e5%9c%ba%e6%99%af-1%e5%ae%9a%e4%bb%b7%e4%b8%8e%e4%bc%98%e6%83%a0%e7%bb%84%e5%90%88%e8%af%84%e4%bc%b0python" aria-label="场景 1：定价与优惠组合评估（Python）">场景 1：定价与优惠组合评估（Python）</a></li>
                <li>
                    <a href="#%e5%9c%ba%e6%99%af-2%e9%a3%8e%e6%8e%a7%e9%a2%9d%e5%ba%a6%e7%bb%84%e5%90%88%e4%bc%b0%e7%ae%97go" aria-label="场景 2：风控额度组合估算（Go）">场景 2：风控额度组合估算（Go）</a></li>
                <li>
                    <a href="#%e5%9c%ba%e6%99%af-3%e5%89%8d%e7%ab%af%e4%bc%98%e6%83%a0%e5%88%b8--%e5%95%86%e5%93%81%e5%8c%b9%e9%85%8djavascript" aria-label="场景 3：前端优惠券 × 商品匹配（JavaScript）">场景 3：前端优惠券 × 商品匹配（JavaScript）</a></li></ul>
                </li>
                <li>
                    <a href="#r--reflection%e5%8f%8d%e6%80%9d%e4%b8%8e%e6%b7%b1%e5%85%a5" aria-label="R — Reflection（反思与深入）">R — Reflection（反思与深入）</a><ul>
                        
                <li>
                    <a href="#1-%e5%a4%8d%e6%9d%82%e5%ba%a6%e5%88%86%e6%9e%90" aria-label="1. 复杂度分析">1. 复杂度分析</a></li>
                <li>
                    <a href="#2-%e6%9b%bf%e4%bb%a3%e6%96%b9%e6%a1%88%e4%b8%8e%e5%b8%b8%e8%a7%81%e9%94%99%e8%af%af" aria-label="2. 替代方案与常见错误">2. 替代方案与常见错误</a></li>
                <li>
                    <a href="#3-%e4%b8%ba%e4%bb%80%e4%b9%88%e6%8e%92%e5%ba%8f--%e4%ba%8c%e5%88%86%e6%9b%b4%e5%b7%a5%e7%a8%8b%e5%8f%af%e8%a1%8c" aria-label="3. 为什么“排序 &#43; 二分”更工程可行？">3. 为什么“排序 + 二分”更工程可行？</a></li></ul>
                </li>
                <li>
                    <a href="#s--summary%e6%80%bb%e7%bb%93" aria-label="S — Summary（总结）">S — Summary（总结）</a></li>
                <li>
                    <a href="#%e5%8f%82%e8%80%83%e4%b8%8e%e5%bb%b6%e4%bc%b8%e9%98%85%e8%af%bb" aria-label="参考与延伸阅读">参考与延伸阅读</a></li>
                <li>
                    <a href="#%e5%a4%9a%e8%af%ad%e8%a8%80%e5%ae%8c%e6%95%b4%e5%ae%9e%e7%8e%b0python--c--c--go--rust--js" aria-label="多语言完整实现（Python / C / C&#43;&#43; / Go / Rust / JS）">多语言完整实现（Python / C / C++ / Go / Rust / JS）</a><ul>
                        
                <li>
                    <a href="#python-%e5%ae%9e%e7%8e%b0" aria-label="Python 实现">Python 实现</a></li>
                <li>
                    <a href="#c-%e5%ae%9e%e7%8e%b0" aria-label="C 实现">C 实现</a></li>
                <li>
                    <a href="#c-%e5%ae%9e%e7%8e%b0-1" aria-label="C&#43;&#43; 实现">C++ 实现</a></li>
                <li>
                    <a href="#go-%e5%ae%9e%e7%8e%b0" aria-label="Go 实现">Go 实现</a></li>
                <li>
                    <a href="#rust-%e5%ae%9e%e7%8e%b0" aria-label="Rust 实现">Rust 实现</a></li>
                <li>
                    <a href="#javascript-%e5%ae%9e%e7%8e%b0" aria-label="JavaScript 实现">JavaScript 实现</a></li></ul>
                </li>
                <li>
                    <a href="#%e8%a1%8c%e5%8a%a8%e5%8f%b7%e5%8f%accta" aria-label="行动号召（CTA）">行动号召（CTA）</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><blockquote>
<p><strong>副标题 / 摘要</strong><br>
一道典型的“乘积 ≥ 阈值”计数题，看起来像是 O(n²) 的双重循环，实际上用「排序 + 二分查找」就能把复杂度压到 O((n+m)log m)。本文从题意抽象、核心公式到多语言实现，带你把这类阈值匹配问题彻底吃透。</p>
</blockquote>
<ul>
<li><strong>预计阅读时长</strong>：10~15 分钟</li>
<li><strong>适用场景标签</strong>：<code>二分查找</code>、<code>排序计数</code>、<code>阈值匹配</code></li>
<li><strong>SEO 关键词</strong>：spells and potions, successful pairs, 二分查找, lower_bound, 乘积约束</li>
</ul>
<hr>
<h2 id="目标读者与背景">目标读者与背景<a hidden class="anchor" aria-hidden="true" href="#目标读者与背景">#</a></h2>
<p><strong>目标读者</strong></p>
<ul>
<li>已熟悉基本二分查找，想提升「在有序数组上做计数」能力的同学</li>
<li>后端 / 算法工程师，经常处理阈值判断与配对统计的问题</li>
<li>准备技术面试，希望积累“排序 + 二分”模板的开发者</li>
</ul>
<p><strong>为什么这题值得单独写一篇？</strong></p>
<ul>
<li>它把一个表面 O(n²) 的「所有配对」问题，转化成了<strong>对有序数组的二分计数</strong>；</li>
<li>公式非常典型：把 <code>a * b ≥ success</code> 转成 <code>b ≥ ceil(success / a)</code>；</li>
<li>这种思路在推荐系统、风控额度、资源匹配等业务里屡见不鲜。</li>
</ul>
<hr>
<h2 id="a--algorithm题目与算法">A — Algorithm（题目与算法）<a hidden class="anchor" aria-hidden="true" href="#a--algorithm题目与算法">#</a></h2>
<h3 id="题目重述">题目重述<a hidden class="anchor" aria-hidden="true" href="#题目重述">#</a></h3>
<blockquote>
<p>给定两个整数数组 <code>spells</code> 和 <code>potions</code>，以及一个正整数 <code>success</code>。<br>
对于每个咒语 <code>spells[i]</code>，我们定义它与药水 <code>potions[j]</code> 的组合是“成功”的，当且仅当：<br>
<code>spells[i] * potions[j] &gt;= success</code><br>
请返回一个数组 <code>ans</code>，其中 <code>ans[i]</code> 表示第 <code>i</code> 个咒语可以与多少个药水形成成功组合。</p>
</blockquote>
<p><strong>输入</strong></p>
<ul>
<li><code>spells</code>: 长度为 <code>n</code> 的整数数组</li>
<li><code>potions</code>: 长度为 <code>m</code> 的整数数组</li>
<li><code>success</code>: 正整数阈值</li>
</ul>
<p><strong>输出</strong></p>
<ul>
<li>整数数组 <code>ans</code>，长度为 <code>n</code>，<code>ans[i]</code> 为每个 <code>spells[i]</code> 能匹配的成功药水数量</li>
</ul>
<h3 id="示例">示例<a hidden class="anchor" aria-hidden="true" href="#示例">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>spells  = [5, 1, 3]
</span></span><span style="display:flex;"><span>potions = [1, 2, 3, 4, 5]
</span></span><span style="display:flex;"><span>success = 7
</span></span></code></pre></div><p>对每个咒语：</p>
<ul>
<li>
<p><code>spell = 5</code>：<br>
需要 <code>5 * potion &gt;= 7</code> → <code>potion &gt;= 7/5 = 1.4</code>，向上取整得到 <code>potion &gt;= 2</code><br>
在 <code>potions</code> 中满足的是 <code>[2, 3, 4, 5]</code>，一共 <code>4</code> 个</p>
</li>
<li>
<p><code>spell = 1</code>：<br>
需要 <code>1 * potion &gt;= 7</code> → <code>potion &gt;= 7</code><br>
<code>potions</code> 里最大也只有 5，所以是 <code>0</code> 个</p>
</li>
<li>
<p><code>spell = 3</code>：<br>
需要 <code>3 * potion &gt;= 7</code> → <code>potion &gt;= 7/3 ≈ 2.33</code>，向上取整得到 <code>potion &gt;= 3</code><br>
满足的是 <code>[3, 4, 5]</code>，一共 <code>3</code> 个</p>
</li>
</ul>
<p>因此答案为：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>ans = [4, 0, 3]
</span></span></code></pre></div><hr>
<h2 id="c--concepts核心思想">C — Concepts（核心思想）<a hidden class="anchor" aria-hidden="true" href="#c--concepts核心思想">#</a></h2>
<h3 id="1-从乘积约束到下界问题">1. 从乘积约束到「下界」问题<a hidden class="anchor" aria-hidden="true" href="#1-从乘积约束到下界问题">#</a></h3>
<p>对固定的咒语值 <code>s = spells[i]</code>，成功条件是：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>s * potions[j] &gt;= success
</span></span></code></pre></div><p>假设我们只考虑 <code>s &gt; 0</code>（若题目存在 0 或负数可额外讨论），可以等价变形为：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>potions[j] &gt;= success / s
</span></span></code></pre></div><p>由于 <code>potions[j]</code> 和 <code>success</code> 是整数，我们要满足：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>potions[j] &gt;= ceil(success / s)
</span></span></code></pre></div><p>记：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>need = ceil(success / s)
</span></span></code></pre></div><p>注意：<br>
<strong>不要使用浮点数</strong>，用整数安全实现向上取整的公式：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>need = (success + s - 1) // s
</span></span></code></pre></div><p>这样，每个咒语的问题就变成了：</p>
<blockquote>
<p>在数组 <code>potions</code> 中，找到第一个 <strong>≥ need</strong> 的位置，下标记为 <code>idx</code>，<br>
则从 <code>idx</code> 到末尾 <code>m-1</code> 的所有药水都满足条件，总数为 <code>m - idx</code>。</p>
</blockquote>
<p>这正是一个标准的「有序数组上找下界（lower_bound）」的问题。</p>
<h3 id="2-为什么要排序">2. 为什么要排序？<a hidden class="anchor" aria-hidden="true" href="#2-为什么要排序">#</a></h3>
<p>二分查找的前提是数组有序。</p>
<p>我们可以：</p>
<ol>
<li>单独对 <code>potions</code> 排序（不影响题意，因为只关心数量，不关心原下标）；</li>
<li>对每个咒语 <code>s</code>：
<ul>
<li>计算 <code>need = ceil(success / s)</code></li>
<li>在排序后的 <code>potions</code> 中，二分找到第一个 <code>&gt;= need</code> 的位置 <code>idx</code></li>
<li>对应成功数为 <code>m - idx</code></li>
</ul>
</li>
</ol>
<p>这样就避免了遍历整个 <code>potions</code> 数组的 O(m) 操作，每个咒语只需 O(log m)。</p>
<h3 id="3-算法类型与复杂度">3. 算法类型与复杂度<a hidden class="anchor" aria-hidden="true" href="#3-算法类型与复杂度">#</a></h3>
<ul>
<li>算法类型：<strong>排序 + 二分查找（lower_bound）</strong></li>
<li>时间复杂度：
<ul>
<li>排序 <code>potions</code>: O(m log m)</li>
<li>对每个 <code>spells[i]</code> 做一次二分：O(n log m)</li>
<li>总体：O((n + m) log m)</li>
</ul>
</li>
<li>空间复杂度：
<ul>
<li>如果在原地排序：O(1) 额外空间（忽略递归栈）</li>
</ul>
</li>
</ul>
<p>与暴力方法 O(n·m) 相比，在 <code>n, m</code> 均为 1e5 级别时，差距非常明显。</p>
<hr>
<h2 id="实践指南--实现步骤">实践指南 / 实现步骤<a hidden class="anchor" aria-hidden="true" href="#实践指南--实现步骤">#</a></h2>
<ol>
<li>
<p><strong>排序 <code>potions</code></strong></p>
<ul>
<li>使用语言内置排序即可（如 <code>sort.Ints</code>、<code>std::sort</code>）。</li>
</ul>
</li>
<li>
<p><strong>遍历每个咒语 <code>s</code></strong></p>
<ul>
<li>
<p>若 <code>s == 0</code>，则 <code>s * potions[j]</code> 永远是 0，不可能 ≥ 正数 <code>success</code>，答案为 0；</p>
</li>
<li>
<p>否则计算：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>need = (success + s - 1) // s
</span></span></code></pre></div></li>
</ul>
</li>
<li>
<p><strong>在排序好的 <code>potions</code> 上二分</strong></p>
<ul>
<li>找到第一个 <code>potions[idx] &gt;= need</code> 的位置；</li>
<li>若 <code>idx == m</code>（越界），说明不存在满足条件的药水，结果为 0；</li>
<li>否则结果为 <code>m - idx</code>。</li>
</ul>
</li>
<li>
<p><strong>收集结果</strong></p>
<ul>
<li>为每个咒语记录这一数量，输出数组 <code>ans</code>。</li>
</ul>
</li>
<li>
<p><strong>边界检查</strong></p>
<ul>
<li><code>spells</code> 或 <code>potions</code> 为空时，直接返回全 0；</li>
<li>注意使用足够大的整数类型保存中间结果（如 <code>long long</code> / <code>int64</code>）。</li>
</ul>
</li>
</ol>
<hr>
<h2 id="e--engineering工程应用">E — Engineering（工程应用）<a hidden class="anchor" aria-hidden="true" href="#e--engineering工程应用">#</a></h2>
<p>下面用三个实际场景，说明这种「排序 + 阈值二分计数」在工程里的用法。</p>
<h3 id="场景-1定价与优惠组合评估python">场景 1：定价与优惠组合评估（Python）<a hidden class="anchor" aria-hidden="true" href="#场景-1定价与优惠组合评估python">#</a></h3>
<p><strong>背景</strong><br>
你有一批商品价格（咒语）和一批折扣系数（药水，例如 0.9、0.8）。你想知道：<br>
对每个商品，<strong>有多少种折扣方案会让折后收入仍然大于某个阈值</strong>？</p>
<p>虽然实际业务多是浮点运算，这里可以简化为整数乘积与阈值比较。</p>
<p><strong>示例代码</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> bisect <span style="color:#f92672">import</span> bisect_left
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> typing <span style="color:#f92672">import</span> List
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">successful_pairs</span>(spells: List[int], potions: List[int], success: int) <span style="color:#f92672">-&gt;</span> List[int]:
</span></span><span style="display:flex;"><span>    potions<span style="color:#f92672">.</span>sort()
</span></span><span style="display:flex;"><span>    m <span style="color:#f92672">=</span> len(potions)
</span></span><span style="display:flex;"><span>    ans <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> s <span style="color:#f92672">in</span> spells:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> s <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            ans<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>        need <span style="color:#f92672">=</span> (success <span style="color:#f92672">+</span> s <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">//</span> s  <span style="color:#75715e"># ceil</span>
</span></span><span style="display:flex;"><span>        idx <span style="color:#f92672">=</span> bisect_left(potions, need)
</span></span><span style="display:flex;"><span>        ans<span style="color:#f92672">.</span>append(m <span style="color:#f92672">-</span> idx)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> ans
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    print(successful_pairs([<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>], [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>], <span style="color:#ae81ff">7</span>))  <span style="color:#75715e"># [4, 0, 3]</span>
</span></span></code></pre></div><hr>
<h3 id="场景-2风控额度组合估算go">场景 2：风控额度组合估算（Go）<a hidden class="anchor" aria-hidden="true" href="#场景-2风控额度组合估算go">#</a></h3>
<p><strong>背景</strong><br>
在风控系统中：</p>
<ul>
<li><code>spells[i]</code> 可以看作借款金额；</li>
<li><code>potions[j]</code> 可以看作担保倍数 / 抵押倍数；</li>
<li><code>success</code> 是一个安全阈值，例如“风险缓释程度”。</li>
</ul>
<p>你希望知道对每一笔借款金额 <code>spells[i]</code>，有多少种担保方案可以让：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>借款金额 * 担保倍数 &gt;= success
</span></span></code></pre></div><p><strong>示例代码</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;sort&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">successfulPairs</span>(<span style="color:#a6e22e">spells</span> []<span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">potions</span> []<span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">success</span> <span style="color:#66d9ef">int64</span>) []<span style="color:#66d9ef">int</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">sort</span>.<span style="color:#a6e22e">Ints</span>(<span style="color:#a6e22e">potions</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">m</span> <span style="color:#f92672">:=</span> len(<span style="color:#a6e22e">potions</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ans</span> <span style="color:#f92672">:=</span> make([]<span style="color:#66d9ef">int</span>, len(<span style="color:#a6e22e">spells</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span>, <span style="color:#a6e22e">s</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">spells</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">s</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">ans</span>[<span style="color:#a6e22e">i</span>] = <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">need</span> <span style="color:#f92672">:=</span> (<span style="color:#a6e22e">success</span> <span style="color:#f92672">+</span> int64(<span style="color:#a6e22e">s</span>) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">/</span> int64(<span style="color:#a6e22e">s</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">idx</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">sort</span>.<span style="color:#a6e22e">Search</span>(<span style="color:#a6e22e">m</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">j</span> <span style="color:#66d9ef">int</span>) <span style="color:#66d9ef">bool</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">return</span> int64(<span style="color:#a6e22e">potions</span>[<span style="color:#a6e22e">j</span>]) <span style="color:#f92672">&gt;=</span> <span style="color:#a6e22e">need</span>
</span></span><span style="display:flex;"><span>		})
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">ans</span>[<span style="color:#a6e22e">i</span>] = <span style="color:#a6e22e">m</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">idx</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ans</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">successfulPairs</span>([]<span style="color:#66d9ef">int</span>{<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>}, []<span style="color:#66d9ef">int</span>{<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>}, <span style="color:#ae81ff">7</span>)) <span style="color:#75715e">// [4 0 3]</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
<h3 id="场景-3前端优惠券--商品匹配javascript">场景 3：前端优惠券 × 商品匹配（JavaScript）<a hidden class="anchor" aria-hidden="true" href="#场景-3前端优惠券--商品匹配javascript">#</a></h3>
<p><strong>背景</strong><br>
在前端你有：</p>
<ul>
<li><code>spells[i]</code>：商品价格；</li>
<li><code>potions[j]</code>：折扣倍数（可近似映射为整数、比方说扩大 100 倍做整数算再除回去）；</li>
<li>你需要计算每个商品能和多少优惠券组合，使得<strong>折后价乘以某个指标仍然 ≥ success</strong>。</li>
</ul>
<p>虽然真实逻辑可能更复杂，但核心都是「一个数组排序，另外一个数组的每个元素用二分找到阈值位置」。</p>
<p><strong>示例代码</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">successfulPairs</span>(<span style="color:#a6e22e">spells</span>, <span style="color:#a6e22e">potions</span>, <span style="color:#a6e22e">success</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">potions</span>.<span style="color:#a6e22e">sort</span>((<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>) =&gt; <span style="color:#a6e22e">a</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">b</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">m</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">potions</span>.<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ans</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">s</span> <span style="color:#66d9ef">of</span> <span style="color:#a6e22e">spells</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">s</span> <span style="color:#f92672">===</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">ans</span>.<span style="color:#a6e22e">push</span>(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">continue</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">need</span> <span style="color:#f92672">=</span> Math.<span style="color:#a6e22e">ceil</span>(<span style="color:#a6e22e">success</span> <span style="color:#f92672">/</span> <span style="color:#a6e22e">s</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">l</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">m</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">l</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">r</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">mid</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">l</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">r</span>) <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">potions</span>[<span style="color:#a6e22e">mid</span>] <span style="color:#f92672">&gt;=</span> <span style="color:#a6e22e">need</span>) <span style="color:#a6e22e">r</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">mid</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">else</span> <span style="color:#a6e22e">l</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">mid</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ans</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">m</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">l</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ans</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">successfulPairs</span>([<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>], [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>], <span style="color:#ae81ff">7</span>)); <span style="color:#75715e">// [4, 0, 3]
</span></span></span></code></pre></div><hr>
<h2 id="r--reflection反思与深入">R — Reflection（反思与深入）<a hidden class="anchor" aria-hidden="true" href="#r--reflection反思与深入">#</a></h2>
<h3 id="1-复杂度分析">1. 复杂度分析<a hidden class="anchor" aria-hidden="true" href="#1-复杂度分析">#</a></h3>
<ul>
<li>
<p>排序 <code>potions</code>：O(m log m)</p>
</li>
<li>
<p>对每个咒语进行二分：O(n log m)</p>
</li>
<li>
<p>总体时间复杂度：<strong>O((n + m) log m)</strong><br>
在 <code>n, m ~ 1e5</code> 的情况下完全可行。</p>
</li>
<li>
<p>空间复杂度：</p>
<ul>
<li>原地排序时，额外空间 O(1)（或 O(log m) 递归栈）。</li>
</ul>
</li>
</ul>
<p>相比之下，<strong>暴力双重循环</strong>的复杂度为 O(n·m)，在大规模数据时会直接超时或导致请求超时。</p>
<hr>
<h3 id="2-替代方案与常见错误">2. 替代方案与常见错误<a hidden class="anchor" aria-hidden="true" href="#2-替代方案与常见错误">#</a></h3>
<p><strong>暴力法</strong>：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>for s in spells:
</span></span><span style="display:flex;"><span>    cnt = 0
</span></span><span style="display:flex;"><span>    for p in potions:
</span></span><span style="display:flex;"><span>        if s * p &gt;= success:
</span></span><span style="display:flex;"><span>            cnt++
</span></span><span style="display:flex;"><span>    ans[i] = cnt
</span></span></code></pre></div><ul>
<li>时间复杂度 O(n·m)；</li>
<li>完全没利用 potions 数组的可重用性和有序性。</li>
</ul>
<p><strong>双指针 + 排序（另一种思路）</strong></p>
<ul>
<li>也可以同时排序 <code>spells</code>（带原下标）和 <code>potions</code>，使用双指针从右往左移动，统计每个咒语能匹配的药水个数；</li>
<li>这也是常见解法之一，但实现上更容易写错边界，对初学者不如二分方案直观。</li>
</ul>
<p><strong>常见错误</strong></p>
<ol>
<li>
<p><strong>直接计算乘积比较导致溢出</strong></p>
<ul>
<li>如果 <code>spells[i]</code> 和 <code>potions[j]</code> 都是 1e9 级别，用 32 位整数相乘会溢出；</li>
<li>推荐用除法：<code>p &gt;= ceil(success / s)</code>，从而避免 <code>s * p</code> 直接计算；</li>
</ul>
</li>
<li>
<p><strong>向上取整写错</strong></p>
<ul>
<li>常见错误写法：<code>need = success / s</code>（这是向下取整，会漏掉边界值）；</li>
<li>正确：<code>need = (success + s - 1) // s</code>。</li>
</ul>
</li>
<li>
<p><strong>忘记排序 <code>potions</code> 再二分</strong></p>
<ul>
<li>二分查找必须建立在有序数组之上，否则结果不可预测。</li>
</ul>
</li>
<li>
<p><strong>忽略 <code>s == 0</code> 的情况</strong></p>
<ul>
<li>若题目允许 <code>spells</code> 中出现 0，需要特判：0 乘以任何非负数都不可能 ≥ 正数 <code>success</code>。</li>
</ul>
</li>
</ol>
<hr>
<h3 id="3-为什么排序--二分更工程可行">3. 为什么“排序 + 二分”更工程可行？<a hidden class="anchor" aria-hidden="true" href="#3-为什么排序--二分更工程可行">#</a></h3>
<ul>
<li>
<p><strong>可读性好</strong>：<br>
代码结构清晰：排序一次 + 每个元素做一次二分；<br>
很容易被团队中其他人理解和复用。</p>
</li>
<li>
<p><strong>性能稳健</strong>：<br>
二分查找操作的复杂度非常稳定，主要耗时集中在排序上；<br>
在数据量很大时也有良好表现。</p>
</li>
<li>
<p><strong>可扩展性强</strong>：<br>
许多类似 “a * b ≥ C” / “a + b ≥ C” / “b ≥ f(a)” 的匹配计数问题都可以按同样方式建模。</p>
</li>
</ul>
<hr>
<h2 id="s--summary总结">S — Summary（总结）<a hidden class="anchor" aria-hidden="true" href="#s--summary总结">#</a></h2>
<ul>
<li>把 <code>spells[i] * potions[j] &gt;= success</code> 转换为 <code>potions[j] &gt;= ceil(success / spells[i])</code> 是本题的核心。</li>
<li>通过对 <code>potions</code> 排序，并对每个咒语用二分查找找“第一个 ≥ need 的位置”，我们可以在 O((n+m)log m) 时间内解题。</li>
<li>相比暴力 O(n·m) 的双重循环，排序 + 二分在大数据场景下更具工程价值。</li>
<li>注意处理整数向上取整、溢出风险以及 <code>s == 0</code> 等边界条件。</li>
<li>这种模式可以迁移到价格组合、风险额度、资源匹配等多个业务场景。</li>
</ul>
<hr>
<h2 id="参考与延伸阅读">参考与延伸阅读<a hidden class="anchor" aria-hidden="true" href="#参考与延伸阅读">#</a></h2>
<ul>
<li>LeetCode 2300. Successful Pairs of Spells and Potions（原题）</li>
<li>其他典型的「排序 + 二分计数」问题：
<ul>
<li>三数之和 / 四数之和中的去重与剪枝</li>
<li>统计区间内小于 / 大于某值的元素个数</li>
</ul>
</li>
<li>《算法导论》排序与二分查找章节</li>
<li>各主流语言标准库的二分查找接口：<code>bisect</code>（Python）、<code>std::lower_bound</code>（C++）、<code>sort.Search</code>（Go）等</li>
</ul>
<hr>
<h2 id="多语言完整实现python--c--c--go--rust--js">多语言完整实现（Python / C / C++ / Go / Rust / JS）<a hidden class="anchor" aria-hidden="true" href="#多语言完整实现python--c--c--go--rust--js">#</a></h2>
<h3 id="python-实现">Python 实现<a hidden class="anchor" aria-hidden="true" href="#python-实现">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> bisect <span style="color:#f92672">import</span> bisect_left
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> typing <span style="color:#f92672">import</span> List
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">successful_pairs</span>(spells: List[int], potions: List[int], success: int) <span style="color:#f92672">-&gt;</span> List[int]:
</span></span><span style="display:flex;"><span>    potions<span style="color:#f92672">.</span>sort()
</span></span><span style="display:flex;"><span>    m <span style="color:#f92672">=</span> len(potions)
</span></span><span style="display:flex;"><span>    ans <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> s <span style="color:#f92672">in</span> spells:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> s <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            ans<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>        need <span style="color:#f92672">=</span> (success <span style="color:#f92672">+</span> s <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">//</span> s
</span></span><span style="display:flex;"><span>        idx <span style="color:#f92672">=</span> bisect_left(potions, need)
</span></span><span style="display:flex;"><span>        ans<span style="color:#f92672">.</span>append(m <span style="color:#f92672">-</span> idx)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> ans
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    print(successful_pairs([<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>], [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>], <span style="color:#ae81ff">7</span>))  <span style="color:#75715e"># [4, 0, 3]</span>
</span></span></code></pre></div><hr>
<h3 id="c-实现">C 实现<a hidden class="anchor" aria-hidden="true" href="#c-实现">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">cmp_int</span>(<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>a, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>b) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> x <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>)a;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> y <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>)b;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> (x <span style="color:#f92672">&gt;</span> y) <span style="color:#f92672">-</span> (x <span style="color:#f92672">&lt;</span> y);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">lower_bound</span>(<span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>arr, <span style="color:#66d9ef">int</span> n, <span style="color:#66d9ef">int</span> target) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> l <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, r <span style="color:#f92672">=</span> n;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (l <span style="color:#f92672">&lt;</span> r) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> mid <span style="color:#f92672">=</span> l <span style="color:#f92672">+</span> (r <span style="color:#f92672">-</span> l) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (arr[mid] <span style="color:#f92672">&gt;=</span> target) r <span style="color:#f92672">=</span> mid;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> l <span style="color:#f92672">=</span> mid <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> l;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">successfulPairs</span>(<span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>spells, <span style="color:#66d9ef">int</span> n, <span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>potions, <span style="color:#66d9ef">int</span> m, <span style="color:#66d9ef">long</span> <span style="color:#66d9ef">long</span> success, <span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>ans) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">qsort</span>(potions, m, <span style="color:#66d9ef">sizeof</span>(<span style="color:#66d9ef">int</span>), cmp_int);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> n; <span style="color:#f92672">++</span>i) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> s <span style="color:#f92672">=</span> spells[i];
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (s <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>            ans[i] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">continue</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">long</span> <span style="color:#66d9ef">long</span> need_ll <span style="color:#f92672">=</span> (success <span style="color:#f92672">+</span> s <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">/</span> s;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (need_ll <span style="color:#f92672">&gt;</span> potions[m <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>]) {
</span></span><span style="display:flex;"><span>            ans[i] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">continue</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> need <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span>)need_ll;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> idx <span style="color:#f92672">=</span> <span style="color:#a6e22e">lower_bound</span>(potions, m, need);
</span></span><span style="display:flex;"><span>        ans[i] <span style="color:#f92672">=</span> m <span style="color:#f92672">-</span> idx;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">void</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> spells[] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>};
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> potions[] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>};
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> n <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>, m <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> ans[<span style="color:#ae81ff">3</span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">successfulPairs</span>(spells, n, potions, m, <span style="color:#ae81ff">7</span>, ans);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> n; <span style="color:#f92672">++</span>i) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%d &#34;</span>, ans[i]);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>); <span style="color:#75715e">// 4 0 3
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
<h3 id="c-实现-1">C++ 实现<a hidden class="anchor" aria-hidden="true" href="#c-实现-1">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;bits/stdc++.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> successfulPairs(vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> spells, vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> potions, <span style="color:#66d9ef">long</span> <span style="color:#66d9ef">long</span> success) {
</span></span><span style="display:flex;"><span>    sort(potions.begin(), potions.end());
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> m <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span>)potions.size();
</span></span><span style="display:flex;"><span>    vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> ans;
</span></span><span style="display:flex;"><span>    ans.reserve(spells.size());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> s : spells) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (s <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>            ans.push_back(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">continue</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">long</span> <span style="color:#66d9ef">long</span> need <span style="color:#f92672">=</span> (success <span style="color:#f92672">+</span> s <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">/</span> s;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">auto</span> it <span style="color:#f92672">=</span> lower_bound(potions.begin(), potions.end(), (<span style="color:#66d9ef">int</span>)need);
</span></span><span style="display:flex;"><span>        ans.push_back((<span style="color:#66d9ef">int</span>)(potions.end() <span style="color:#f92672">-</span> it));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> ans;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> spells{<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>};
</span></span><span style="display:flex;"><span>    vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> potions{<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>};
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> ans <span style="color:#f92672">=</span> successfulPairs(spells, potions, <span style="color:#ae81ff">7</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> x : ans) cout <span style="color:#f92672">&lt;&lt;</span> x <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34; &#34;</span>;
</span></span><span style="display:flex;"><span>    cout <span style="color:#f92672">&lt;&lt;</span> endl; <span style="color:#75715e">// 4 0 3
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
<h3 id="go-实现">Go 实现<a hidden class="anchor" aria-hidden="true" href="#go-实现">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;sort&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">successfulPairs</span>(<span style="color:#a6e22e">spells</span> []<span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">potions</span> []<span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">success</span> <span style="color:#66d9ef">int64</span>) []<span style="color:#66d9ef">int</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">sort</span>.<span style="color:#a6e22e">Ints</span>(<span style="color:#a6e22e">potions</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">m</span> <span style="color:#f92672">:=</span> len(<span style="color:#a6e22e">potions</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ans</span> <span style="color:#f92672">:=</span> make([]<span style="color:#66d9ef">int</span>, len(<span style="color:#a6e22e">spells</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span>, <span style="color:#a6e22e">s</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">spells</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">s</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">ans</span>[<span style="color:#a6e22e">i</span>] = <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">need</span> <span style="color:#f92672">:=</span> (<span style="color:#a6e22e">success</span> <span style="color:#f92672">+</span> int64(<span style="color:#a6e22e">s</span>) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">/</span> int64(<span style="color:#a6e22e">s</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">idx</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">sort</span>.<span style="color:#a6e22e">Search</span>(<span style="color:#a6e22e">m</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">j</span> <span style="color:#66d9ef">int</span>) <span style="color:#66d9ef">bool</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">return</span> int64(<span style="color:#a6e22e">potions</span>[<span style="color:#a6e22e">j</span>]) <span style="color:#f92672">&gt;=</span> <span style="color:#a6e22e">need</span>
</span></span><span style="display:flex;"><span>		})
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">ans</span>[<span style="color:#a6e22e">i</span>] = <span style="color:#a6e22e">m</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">idx</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ans</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">successfulPairs</span>([]<span style="color:#66d9ef">int</span>{<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>}, []<span style="color:#66d9ef">int</span>{<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>}, <span style="color:#ae81ff">7</span>)) <span style="color:#75715e">// [4 0 3]</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
<h3 id="rust-实现">Rust 实现<a hidden class="anchor" aria-hidden="true" href="#rust-实现">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">successful_pairs</span>(spells: Vec<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">i32</span><span style="color:#f92672">&gt;</span>, <span style="color:#66d9ef">mut</span> potions: Vec<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">i32</span><span style="color:#f92672">&gt;</span>, success: <span style="color:#66d9ef">i64</span>) -&gt; Vec<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">i32</span><span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    potions.sort();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> m <span style="color:#f92672">=</span> potions.len();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#66d9ef">mut</span> ans <span style="color:#f92672">=</span> Vec::with_capacity(spells.len());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> s <span style="color:#66d9ef">in</span> spells {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> s <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> {
</span></span><span style="display:flex;"><span>            ans.push(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">continue</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> need <span style="color:#f92672">=</span> (success <span style="color:#f92672">+</span> s <span style="color:#66d9ef">as</span> <span style="color:#66d9ef">i64</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">/</span> s <span style="color:#66d9ef">as</span> <span style="color:#66d9ef">i64</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> idx <span style="color:#f92672">=</span> potions
</span></span><span style="display:flex;"><span>            .binary_search_by(<span style="color:#f92672">|&amp;</span>p<span style="color:#f92672">|</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (p <span style="color:#66d9ef">as</span> <span style="color:#66d9ef">i64</span>) <span style="color:#f92672">&lt;</span> need {
</span></span><span style="display:flex;"><span>                    std::cmp::Ordering::Less
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                    std::cmp::Ordering::Greater
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            })
</span></span><span style="display:flex;"><span>            .unwrap_or_else(<span style="color:#f92672">|</span>i<span style="color:#f92672">|</span> i);
</span></span><span style="display:flex;"><span>        ans.push((m <span style="color:#f92672">-</span> idx) <span style="color:#66d9ef">as</span> <span style="color:#66d9ef">i32</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    ans
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> spells <span style="color:#f92672">=</span> <span style="color:#a6e22e">vec!</span>[<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> potions <span style="color:#f92672">=</span> <span style="color:#a6e22e">vec!</span>[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> ans <span style="color:#f92672">=</span> successful_pairs(spells, potions, <span style="color:#ae81ff">7</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">println!</span>(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{:?}</span><span style="color:#e6db74">&#34;</span>, ans); <span style="color:#75715e">// [4, 0, 3]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><hr>
<h3 id="javascript-实现">JavaScript 实现<a hidden class="anchor" aria-hidden="true" href="#javascript-实现">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">successfulPairs</span>(<span style="color:#a6e22e">spells</span>, <span style="color:#a6e22e">potions</span>, <span style="color:#a6e22e">success</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">potions</span>.<span style="color:#a6e22e">sort</span>((<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>) =&gt; <span style="color:#a6e22e">a</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">b</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">m</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">potions</span>.<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ans</span> <span style="color:#f92672">=</span> [];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">s</span> <span style="color:#66d9ef">of</span> <span style="color:#a6e22e">spells</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">s</span> <span style="color:#f92672">===</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">ans</span>.<span style="color:#a6e22e">push</span>(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">continue</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">need</span> <span style="color:#f92672">=</span> Math.<span style="color:#a6e22e">ceil</span>(<span style="color:#a6e22e">success</span> <span style="color:#f92672">/</span> <span style="color:#a6e22e">s</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">l</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">m</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">l</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">r</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">mid</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">l</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">r</span>) <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">potions</span>[<span style="color:#a6e22e">mid</span>] <span style="color:#f92672">&gt;=</span> <span style="color:#a6e22e">need</span>) <span style="color:#a6e22e">r</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">mid</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">else</span> <span style="color:#a6e22e">l</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">mid</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ans</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">m</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">l</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ans</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">successfulPairs</span>([<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>], [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>], <span style="color:#ae81ff">7</span>)); <span style="color:#75715e">// [4, 0, 3]
</span></span></span></code></pre></div><hr>
<h2 id="行动号召cta">行动号召（CTA）<a hidden class="anchor" aria-hidden="true" href="#行动号召cta">#</a></h2>
<ul>
<li>把这道题按你最熟悉的语言手写一遍，并把「排序 + 下界二分」抽成一个通用工具函数。</li>
<li>回顾你项目中的阈值匹配逻辑，看能否用“先排序再二分计数”的方式重构一处性能瓶颈。</li>
<li>挑几道类似的「≥ 阈值配对计数」题（如配对和 ≥ K、配对差值 ≤ K），试着用同样思路建模并实现。</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/">二分查找</a></li>
      <li><a href="http://localhost:1313/tags/%E6%8E%92%E5%BA%8F/">排序</a></li>
      <li><a href="http://localhost:1313/tags/%E6%95%B0%E7%BB%84/">数组</a></li>
      <li><a href="http://localhost:1313/tags/%E5%8F%8C%E6%8C%87%E9%92%88/">双指针</a></li>
      <li><a href="http://localhost:1313/tags/%E9%9D%A2%E8%AF%95%E9%AB%98%E9%A2%91%E9%A2%98/">面试高频题</a></li>
    </ul>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 咒语与药水的成功组合：排序 &#43; 二分查找秒杀乘积约束问题 on x"
            href="https://x.com/intent/tweet/?text=%e5%92%92%e8%af%ad%e4%b8%8e%e8%8d%af%e6%b0%b4%e7%9a%84%e6%88%90%e5%8a%9f%e7%bb%84%e5%90%88%ef%bc%9a%e6%8e%92%e5%ba%8f%20%2b%20%e4%ba%8c%e5%88%86%e6%9f%a5%e6%89%be%e7%a7%92%e6%9d%80%e4%b9%98%e7%a7%af%e7%ba%a6%e6%9d%9f%e9%97%ae%e9%a2%98&amp;url=http%3a%2f%2flocalhost%3a1313%2falg%2fleetcode%2fspells-and-potions-successful-pairs%2f&amp;hashtags=%e4%ba%8c%e5%88%86%e6%9f%a5%e6%89%be%2c%e6%8e%92%e5%ba%8f%2c%e6%95%b0%e7%bb%84%2c%e5%8f%8c%e6%8c%87%e9%92%88%2c%e9%9d%a2%e8%af%95%e9%ab%98%e9%a2%91%e9%a2%98">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 咒语与药水的成功组合：排序 &#43; 二分查找秒杀乘积约束问题 on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2falg%2fleetcode%2fspells-and-potions-successful-pairs%2f&amp;title=%e5%92%92%e8%af%ad%e4%b8%8e%e8%8d%af%e6%b0%b4%e7%9a%84%e6%88%90%e5%8a%9f%e7%bb%84%e5%90%88%ef%bc%9a%e6%8e%92%e5%ba%8f%20%2b%20%e4%ba%8c%e5%88%86%e6%9f%a5%e6%89%be%e7%a7%92%e6%9d%80%e4%b9%98%e7%a7%af%e7%ba%a6%e6%9d%9f%e9%97%ae%e9%a2%98&amp;summary=%e5%92%92%e8%af%ad%e4%b8%8e%e8%8d%af%e6%b0%b4%e7%9a%84%e6%88%90%e5%8a%9f%e7%bb%84%e5%90%88%ef%bc%9a%e6%8e%92%e5%ba%8f%20%2b%20%e4%ba%8c%e5%88%86%e6%9f%a5%e6%89%be%e7%a7%92%e6%9d%80%e4%b9%98%e7%a7%af%e7%ba%a6%e6%9d%9f%e9%97%ae%e9%a2%98&amp;source=http%3a%2f%2flocalhost%3a1313%2falg%2fleetcode%2fspells-and-potions-successful-pairs%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 咒语与药水的成功组合：排序 &#43; 二分查找秒杀乘积约束问题 on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2falg%2fleetcode%2fspells-and-potions-successful-pairs%2f&title=%e5%92%92%e8%af%ad%e4%b8%8e%e8%8d%af%e6%b0%b4%e7%9a%84%e6%88%90%e5%8a%9f%e7%bb%84%e5%90%88%ef%bc%9a%e6%8e%92%e5%ba%8f%20%2b%20%e4%ba%8c%e5%88%86%e6%9f%a5%e6%89%be%e7%a7%92%e6%9d%80%e4%b9%98%e7%a7%af%e7%ba%a6%e6%9d%9f%e9%97%ae%e9%a2%98">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 咒语与药水的成功组合：排序 &#43; 二分查找秒杀乘积约束问题 on facebook"
            href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2falg%2fleetcode%2fspells-and-potions-successful-pairs%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 咒语与药水的成功组合：排序 &#43; 二分查找秒杀乘积约束问题 on whatsapp"
            href="https://api.whatsapp.com/send?text=%e5%92%92%e8%af%ad%e4%b8%8e%e8%8d%af%e6%b0%b4%e7%9a%84%e6%88%90%e5%8a%9f%e7%bb%84%e5%90%88%ef%bc%9a%e6%8e%92%e5%ba%8f%20%2b%20%e4%ba%8c%e5%88%86%e6%9f%a5%e6%89%be%e7%a7%92%e6%9d%80%e4%b9%98%e7%a7%af%e7%ba%a6%e6%9d%9f%e9%97%ae%e9%a2%98%20-%20http%3a%2f%2flocalhost%3a1313%2falg%2fleetcode%2fspells-and-potions-successful-pairs%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 咒语与药水的成功组合：排序 &#43; 二分查找秒杀乘积约束问题 on telegram"
            href="https://telegram.me/share/url?text=%e5%92%92%e8%af%ad%e4%b8%8e%e8%8d%af%e6%b0%b4%e7%9a%84%e6%88%90%e5%8a%9f%e7%bb%84%e5%90%88%ef%bc%9a%e6%8e%92%e5%ba%8f%20%2b%20%e4%ba%8c%e5%88%86%e6%9f%a5%e6%89%be%e7%a7%92%e6%9d%80%e4%b9%98%e7%a7%af%e7%ba%a6%e6%9d%9f%e9%97%ae%e9%a2%98&amp;url=http%3a%2f%2flocalhost%3a1313%2falg%2fleetcode%2fspells-and-potions-successful-pairs%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 咒语与药水的成功组合：排序 &#43; 二分查找秒杀乘积约束问题 on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=%e5%92%92%e8%af%ad%e4%b8%8e%e8%8d%af%e6%b0%b4%e7%9a%84%e6%88%90%e5%8a%9f%e7%bb%84%e5%90%88%ef%bc%9a%e6%8e%92%e5%ba%8f%20%2b%20%e4%ba%8c%e5%88%86%e6%9f%a5%e6%89%be%e7%a7%92%e6%9d%80%e4%b9%98%e7%a7%af%e7%ba%a6%e6%9d%9f%e9%97%ae%e9%a2%98&u=http%3a%2f%2flocalhost%3a1313%2falg%2fleetcode%2fspells-and-potions-successful-pairs%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="http://localhost:1313/">Jeanphilo Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
